{
  "system_name": "AXIS_APP_INTEGRATION_GUIDE",
  "version": "1.0",
  "philosophy": "Common apps = Common patterns. Don't reinvent the wheel.",
  "objective": "Provide AI with knowledge of popular Shopify apps and their integration methods.",
  "integration_categories": {
    "subscriptions": ["ReCharge", "Seal Subscriptions", "Smartrr"],
    "reviews": ["Yotpo", "Judge.me", "Loox", "Stamped.io"],
    "wishlist": ["Wishlist Plus", "Swym", "Growave"],
    "email_marketing": ["Klaviyo", "Omnisend", "Mailchimp"],
    "search": ["Searchanise", "Boost Product Filter", "Fast Simon"],
    "upsell": ["Bold Upsell", "Zipify", "ReConvert"],
    "inventory": ["BackInStock", "PreOrder Now"],
    "loyalty": ["Smile.io", "LoyaltyLion", "Yotpo Loyalty"]
  },
  "app_registry": {
    "recharge": {
      "name": "ReCharge Subscriptions",
      "category": "subscriptions",
      "popularity": "Market Leader (50k+ merchants)",
      "integration_method": "Liquid Snippet Render",
      "installation_steps": [
        "Install ReCharge app from Shopify App Store",
        "ReCharge auto-generates snippet: 'subscription-widget.liquid'",
        "Render in product template"
      ],
      "code_pattern": {
        "liquid": "{% render 'subscription-widget', product: product %}",
        "placement": "sections/main-product.liquid (after Add to Cart button)",
        "notes": "ReCharge handles all logic internally. No custom JS needed."
      },
      "schema_integration": {
        "add_to_section_settings": {
          "type": "checkbox",
          "id": "enable_subscriptions",
          "label": "Enable Subscription Option",
          "default": false,
          "info": "Requires ReCharge app installed"
        }
      },
      "conditional_render": "{% if section.settings.enable_subscriptions %}\n  {% render 'subscription-widget', product: product %}\n{% endif %}",
      "documentation": "https://support.rechargepayments.com/hc/en-us/articles/360008829993"
    },
    "yotpo": {
      "name": "Yotpo Reviews & Ratings",
      "category": "reviews",
      "popularity": "300k+ merchants",
      "integration_method": "JavaScript Snippet + Div Placeholder",
      "installation_steps": [
        "Install Yotpo app",
        "Copy App Key from Yotpo dashboard",
        "Add JS snippet to theme.liquid",
        "Add div placeholders where reviews should appear"
      ],
      "code_pattern": {
        "theme_liquid_head": "<script type=\"text/javascript\">\n(function e(){var e=document.createElement(\"script\");e.type=\"text/javascript\",e.async=true,e.src=\"//staticw2.yotpo.com/YOUR_APP_KEY/widget.js\";var t=document.getElementsByTagName(\"script\")[0];t.parentNode.insertBefore(e,t)})();\n</script>",
        "product_page": "<div class=\"yotpo bottomLine\" data-product-id=\"{{ product.id }}\" data-url=\"{{ shop.url }}{{ product.url }}\"></div>",
        "reviews_section": "<div class=\"yotpo yotpo-main-widget\" data-product-id=\"{{ product.id }}\"></div>"
      },
      "schema_integration": {
        "add_to_section_settings": {
          "type": "checkbox",
          "id": "enable_reviews",
          "label": "Show Product Reviews",
          "default": true
        }
      },
      "performance_note": "Yotpo JS is ~80KB. Consider lazy-loading below fold.",
      "documentation": "https://support.yotpo.com/en/article/installing-yotpo-on-shopify"
    },
    "klaviyo": {
      "name": "Klaviyo Email Marketing",
      "category": "email_marketing",
      "popularity": "100k+ merchants",
      "integration_method": "Form Submission to Klaviyo API",
      "installation_steps": [
        "Install Klaviyo app",
        "Create List in Klaviyo dashboard",
        "Get List ID",
        "Integrate form submission"
      ],
      "code_pattern": {
        "html_form": "<form class=\"klaviyo-form\" data-list-id=\"YOUR_LIST_ID\">
  <input type=\"email\" name=\"email\" placeholder=\"Enter your email\" required>
  <button type=\"submit\">Subscribe</button>
</form>",
        "javascript": "document.querySelector('.klaviyo-form').addEventListener('submit', async (e) => {\n  e.preventDefault();\n  const email = e.target.email.value;\n  const listId = e.target.dataset.listId;\n  \n  const response = await fetch('https://a.klaviyo.com/api/v2/list/' + listId + '/subscribe', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ api_key: 'YOUR_PUBLIC_API_KEY', profiles: [{ email }] })\n  });\n  \n  if (response.ok) alert('Subscribed!');\n});"
      },
      "security_note": "Use PUBLIC API Key only (not Private Key). Never expose Private Key in frontend code.",
      "documentation": "https://help.klaviyo.com/hc/en-us/articles/115005082927"
    },
    "judgeme": {
      "name": "Judge.me Product Reviews",
      "category": "reviews",
      "popularity": "Budget-friendly alternative to Yotpo",
      "integration_method": "Liquid Snippet Render (App Blocks)",
      "installation_steps": [
        "Install Judge.me app",
        "App auto-injects into Product Page",
        "Customize via Theme Editor"
      ],
      "code_pattern": {
        "app_block": "Use @app blocks in sections/main-product.liquid",
        "manual_integration": "{% render 'judgeme_widgets', widget_type: 'judgeme_review_widget', product: product %}"
      },
      "advantage": "Uses App Blocks (Online Store 2.0 native) - no code needed",
      "documentation": "https://judge.me/support"
    },
    "searchanise": {
      "name": "Searchanise Smart Search",
      "category": "search",
      "popularity": "Fast autocomplete + filters",
      "integration_method": "JavaScript Widget Replacement",
      "installation_steps": [
        "Install Searchanise app",
        "App replaces native Shopify search with its widget",
        "Customize in Searchanise dashboard"
      ],
      "code_pattern": {
        "automatic": "App auto-injects. No manual code needed.",
        "custom_trigger": "Add data-snize-search attribute to search input"
      },
      "performance_note": "Searchanise loads asynchronously. No LCP impact.",
      "documentation": "https://searchanise.io/docs/"
    },
    "smile_io": {
      "name": "Smile.io Rewards & Loyalty",
      "category": "loyalty",
      "popularity": "Gamification leader",
      "integration_method": "JavaScript Launcher + Points Display",
      "installation_steps": [
        "Install Smile.io app",
        "Copy embed code",
        "Add to theme.liquid"
      ],
      "code_pattern": {
        "theme_liquid_body": "<div id=\"smile-ui-container\"></div>\n<script src=\"https://js.smile.io/v1/smile-shopify.js\"></script>",
        "points_display": "<span class=\"smile-points-balance\" data-customer-id=\"{{ customer.id }}\"></span>"
      },
      "documentation": "https://docs.smile.io/docs/shopify-setup"
    }
  },
  "generic_integration_patterns": {
    "pattern_1_liquid_snippet": {
      "description": "App provides a Liquid snippet (e.g., app-widget.liquid)",
      "steps": [
        "Install app",
        "App auto-creates snippet in /snippets",
        "Render snippet: {% render 'app-widget' %}"
      ],
      "when_to_use": "Most Shopify-native apps use this method"
    },
    "pattern_2_app_blocks": {
      "description": "App registers as App Block (Online Store 2.0)",
      "steps": [
        "Install app",
        "Go to Theme Editor > Product Page",
        "Click 'Add Block' > Select app from list",
        "Configure in Theme Editor"
      ],
      "when_to_use": "Modern apps built for OS 2.0",
      "code_example": "No code needed. App appears in sections schema automatically."
    },
    "pattern_3_javascript_widget": {
      "description": "App provides JS snippet to inject into theme.liquid",
      "steps": [
        "Install app",
        "Copy JS snippet from app dashboard",
        "Paste in theme.liquid <head> or before </body>",
        "Add div placeholders where widget should render"
      ],
      "when_to_use": "Reviews, chat, popups, analytics",
      "security_warning": "Verify script source is HTTPS and from official domain"
    },
    "pattern_4_api_integration": {
      "description": "Direct API calls to app's backend",
      "steps": [
        "Get API Key from app dashboard",
        "Store API Key in theme settings (NOT in code)",
        "Make fetch() calls to app's API endpoint"
      ],
      "when_to_use": "Email marketing, inventory sync, custom workflows",
      "security_rule": "NEVER expose Private API Keys. Use server-side proxy if needed."
    }
  },
  "axis_integration_protocol": {
    "step_1_identify": "Detect app name in user query (e.g., 'Add ReCharge')",
    "step_2_lookup": "Search app_registry for matching entry",
    "step_3_method": "Check 'integration_method' (Liquid, JS, App Block, API)",
    "step_4_generate": "Output code using 'code_pattern'",
    "step_5_document": "Add setup instructions to merchant guide (File 04)",
    "step_6_dependency": "Log in DEPENDENCY.md (File 09): 'Requires ReCharge app installed'"
  },
  "unknown_app_fallback": {
    "action": "If app not in registry, provide generic guidance",
    "response_template": "I don't have specific integration details for [APP_NAME], but here's how to integrate it:\n\n1. Install the app from Shopify App Store\n2. Check if it uses:\n   - App Blocks (easiest - no code needed)\n   - Liquid snippets (check /snippets folder after install)\n   - JavaScript widget (check app documentation for embed code)\n3. Refer to the app's official documentation: [LINK]\n4. If you share the app's integration guide, I can generate the exact code."
  },
  "testing_checklist": {
    "pre_launch": [
      "Verify app is installed in Shopify Admin",
      "Check app appears in Theme Editor (if using App Blocks)",
      "Test app functionality on staging theme",
      "Verify no JavaScript errors in browser console",
      "Check mobile responsiveness of app widget"
    ],
    "performance": [
      "Run Lighthouse with app active",
      "Ensure app JS doesn't block rendering",
      "Check if app impacts LCP (should be < 2.5s)"
    ]
  },
  "migration_notes": {
    "when_switching_apps": {
      "example": "Switching from Yotpo to Judge.me",
      "steps": [
        "Uninstall old app (Yotpo)",
        "Remove old app code from theme (search for 'yotpo' in theme files)",
        "Install new app (Judge.me)",
        "Integrate new app using pattern above",
        "Test thoroughly before going live"
      ],
      "data_migration": "Most review apps offer CSV import. Export from old app, import to new app."
    },
    "legacy_themes": {
      "problem": "Old themes may not support App Blocks",
      "solution": "Use Liquid snippet or JS widget method instead"
    }
  },
  "performance_optimization": {
    "lazy_load_apps": {
      "description": "Load app JS only when needed",
      "code_example": "// Load Yotpo only when reviews section is visible\nconst observer = new IntersectionObserver((entries) => {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      const script = document.createElement('script');\n      script.src = '//staticw2.yotpo.com/YOUR_APP_KEY/widget.js';\n      document.head.appendChild(script);\n      observer.disconnect();\n    }\n  });\n});\nobserver.observe(document.querySelector('.yotpo'));"
    },
    "defer_non_critical": {
      "rule": "If app doesn't affect above-the-fold content, defer its JS",
      "example": "<script src=\"app.js\" defer></script>"
    }
  },
  "troubleshooting": {
    "app_not_showing": [
      "Check if app is active in Shopify Admin > Apps",
      "Verify app code is in correct location (header vs footer)",
      "Check browser console for JavaScript errors",
      "Clear browser cache and test in incognito mode"
    ],
    "performance_issues": [
      "Check if app JS is blocking render (use Lighthouse)",
      "Consider lazy-loading app below the fold",
      "Contact app support for optimized integration"
    ],
    "conflicts": [
      "If two apps conflict, check if both modify same DOM elements",
      "Test apps one at a time to isolate issue",
      "Check app z-index if overlapping"
    ]
  }
}
